# ğŸ”§ CSVæ–‡ä»¶ç¼–ç é—®é¢˜ä¿®å¤è¯´æ˜

## âŒ åŸé—®é¢˜

è¿è¡Œå¿«é€Ÿæµ‹è¯•æ—¶é‡åˆ°ç¼–ç é”™è¯¯ï¼š
```
'utf-8' codec can't decode byte 0xb1 in position 0: invalid start byte
```

## âœ… åŸå› åˆ†æ

ä½ çš„CSVæ–‡ä»¶ç¬¬ä¸€è¡ŒåŒ…å«ä¸­æ–‡å¹¿å‘Šï¼Œä½¿ç”¨çš„æ˜¯ **GBK/GB18030** ç¼–ç ï¼Œè€Œä¸æ˜¯UTF-8ã€‚

## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ

å·²ä¿®æ”¹ `spike_strategy_backtest.py` ä¸­çš„ `load_symbol_data` å‡½æ•°ï¼Œæ”¯æŒè‡ªåŠ¨å°è¯•å¤šç§ç¼–ç ï¼š

```python
# ä¿®æ”¹å‰ï¼ˆåªæ”¯æŒUTF-8ï¼‰
df = pd.read_csv(symbol_file, skiprows=1)

# ä¿®æ”¹åï¼ˆæ”¯æŒå¤šç§ç¼–ç ï¼‰
for encoding in ['gbk', 'gb18030', 'gb2312', 'utf-8', 'latin1']:
    try:
        df = pd.read_csv(symbol_file, skiprows=1, encoding=encoding)
        break
    except (UnicodeDecodeError, LookupError):
        continue
```

## ğŸ§ª æµ‹è¯•ä¿®å¤

### æ–¹å¼1ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

```bash
cd /Users/wang/PythonProjects/coin-cta/spike_trade_bot/
python test_encoding_fix.py
```

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… æˆåŠŸåŠ è½½ BTC-USDT
ğŸ“Š æ•°æ®è¡Œæ•°: XXXX
ğŸ“… æ—¶é—´èŒƒå›´: ...
âœ… ç¼–ç é—®é¢˜å·²ä¿®å¤ï¼
```

### æ–¹å¼2ï¼šé‡æ–°è¿è¡Œå¿«é€Ÿæµ‹è¯•

```bash
./run_spike_strategy.sh
# é€‰æ‹© 1 - å¿«é€Ÿæµ‹è¯•
```

æˆ–è€…ï¼š

```bash
python spike_strategy_quick_test.py
# é€‰æ‹© 1
```

## âœ… ä¿®å¤èŒƒå›´

ä»¥ä¸‹æ‰€æœ‰ç¨‹åºéƒ½å·²è‡ªåŠ¨ä¿®å¤ï¼ˆå› ä¸ºå®ƒä»¬éƒ½å¯¼å…¥ç›¸åŒçš„å‡½æ•°ï¼‰ï¼š
- âœ… `spike_strategy_backtest.py` - å®Œæ•´å›æµ‹
- âœ… `spike_strategy_quick_test.py` - å¿«é€Ÿæµ‹è¯•
- âœ… `spike_strategy_optimizer.py` - å‚æ•°ä¼˜åŒ–
- âœ… `spike_strategy_visualize.py` - å¯è§†åŒ–ï¼ˆå¦‚éœ€è¦ï¼‰

## ğŸ“‹ ç°åœ¨å¯ä»¥åšä»€ä¹ˆ

### ç«‹å³è¿è¡Œå¿«é€Ÿæµ‹è¯•

```bash
cd /Users/wang/PythonProjects/coin-cta/spike_trade_bot/
python spike_strategy_quick_test.py
```

é€‰æ‹© `1` è¿›è¡Œå¿«é€Ÿå›æµ‹ï¼Œåº”è¯¥èƒ½æ­£å¸¸åŠ è½½æ•°æ®äº†ï¼

### æŸ¥çœ‹æ’é’ˆä¿¡å·

```bash
python spike_strategy_quick_test.py
```

é€‰æ‹© `2` æŸ¥çœ‹BTCçš„æ’é’ˆä¿¡å·ã€‚

### è¿è¡Œå®Œæ•´å›æµ‹

```bash
python spike_strategy_backtest.py
```

## ğŸ¯ å¦‚æœè¿˜æœ‰é—®é¢˜

### é—®é¢˜1ï¼šä»ç„¶æŠ¥ç¼–ç é”™è¯¯

**å¯èƒ½åŸå› **ï¼šæ–‡ä»¶ä½¿ç”¨äº†å…¶ä»–ç¼–ç 

**è§£å†³æ–¹æ³•**ï¼šæ‰“å¼€ `spike_strategy_backtest.py`ï¼Œåœ¨ç¬¬543è¡Œæ‰¾åˆ°ç¼–ç åˆ—è¡¨ï¼Œæ·»åŠ å…¶ä»–ç¼–ç ï¼š

```python
for encoding in ['gbk', 'gb18030', 'gb2312', 'utf-8', 'utf-16', 'latin1']:
```

### é—®é¢˜2ï¼šNo module named 'pandas'

**è§£å†³æ–¹æ³•**ï¼šå®‰è£…ä¾èµ–

```bash
pip install pandas numpy matplotlib
```

### é—®é¢˜3ï¼šæ•°æ®è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼šç¼–è¾‘ `spike_strategy_config.py`ï¼Œç¡®è®¤ç¬¬18è¡Œçš„è·¯å¾„æ­£ç¡®ï¼š

```python
data_path = Path(r'/Users/wang/PythonProjects/xingda/data/coin-binance-swap-candle-csv-1h-2025-11-12/')
```

## ğŸ’¡ æŠ€æœ¯è¯´æ˜

### æ”¯æŒçš„ç¼–ç ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

1. **GBK** - ç®€ä½“ä¸­æ–‡æ ‡å‡†ç¼–ç 
2. **GB18030** - ä¸­æ–‡ç¼–ç æ‰©å±•
3. **GB2312** - ç®€ä½“ä¸­æ–‡åŸºç¡€ç¼–ç 
4. **UTF-8** - å›½é™…é€šç”¨ç¼–ç 
5. **Latin1** - å…œåº•ç¼–ç 

ç¨‹åºä¼šè‡ªåŠ¨å°è¯•è¿™äº›ç¼–ç ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªèƒ½æˆåŠŸè§£ç çš„ç¼–ç ååœæ­¢ã€‚

### ä¸ºä»€ä¹ˆCSVæ˜¯GBKç¼–ç ï¼Ÿ

å¾ˆå¤šWindowsç³»ç»Ÿã€Excelå¯¼å‡ºçš„CSVæ–‡ä»¶é»˜è®¤ä½¿ç”¨GBKç¼–ç ï¼Œç‰¹åˆ«æ˜¯åŒ…å«ä¸­æ–‡çš„æ–‡ä»¶ã€‚

## âœ… æ€»ç»“

âœ… **é—®é¢˜å·²ä¿®å¤**ï¼šæ”¯æŒGBK/GB18030ç­‰ä¸­æ–‡ç¼–ç   
âœ… **å½±å“èŒƒå›´**ï¼šæ‰€æœ‰å›æµ‹ã€æµ‹è¯•ã€ä¼˜åŒ–ç¨‹åº  
âœ… **æ— éœ€é¢å¤–é…ç½®**ï¼šè‡ªåŠ¨è¯†åˆ«ç¼–ç   
âœ… **å¯ä»¥å¼€å§‹ä½¿ç”¨**ï¼šç«‹å³è¿è¡Œæµ‹è¯•å³å¯  

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025-11-21  
**ä¿®å¤æ–‡ä»¶**ï¼š`spike_strategy_backtest.py` (line 537-550)


